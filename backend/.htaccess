# Backend Security Configuration

# Prevent directory listing
Options -Indexes

# Enable CORS for all API endpoints
# CORS and OPTIONS handled by PHP (backend/config/cors.php)


# Ensure JSON responses are properly handled
<IfModule mod_mime.c>
    AddType application/json .json
</IfModule>

# Enable error logging
php_flag display_errors Off
php_flag log_errors On

# Pass Authorization header to PHP
RewriteEngine On
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]

# Prevent access to diagnostic and schema tools
<FilesMatch "^(check_|diagnose_|setup_|list_|schema_|debug_|test_).*\.(php|txt|log)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Prevent access to sensitive environment and dependency files
<FilesMatch "^\.env|composer\.(json|lock)|package(-lock)?\.json|\.git|\.gitignore|\.md|LICENSE|README">
    Order Deny,Allow
    Deny from all
</FilesMatch>
