2026-02-06 01:47:06 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:06 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:06 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:06 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:07 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:07 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:07 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:07 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:07 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:07 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:07 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:08 - Request: {"limit":"20","offset":"0","risk_level":"at_risk"}
2026-02-06 01:47:08 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level = ? GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:09 - Request: {"limit":"20","offset":"0","risk_level":"warning"}
2026-02-06 01:47:09 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level = ? GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:35 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:35 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:35 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:35 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:35 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:35 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:35 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:35 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:35 - Request: {"limit":"20","offset":"0","risk_level":"risky"}
2026-02-06 01:47:35 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level IN ('critical', 'at_risk', 'warning') GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:37 - Request: {"limit":"20","offset":"0","risk_level":"critical"}
2026-02-06 01:47:37 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level = ? GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:38 - Request: {"limit":"20","offset":"0","risk_level":"at_risk"}
2026-02-06 01:47:38 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level = ? GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:39 - Request: {"limit":"20","offset":"0","risk_level":"warning"}
2026-02-06 01:47:39 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level = ? GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:41 - Request: {"limit":"20","offset":"0","risk_level":"warning","program_id":"1"}
2026-02-06 01:47:41 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level = ? AND u.program_id = ? GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
2026-02-06 01:47:42 - Request: {"limit":"20","offset":"0","risk_level":"at_risk","program_id":"1"}
2026-02-06 01:47:42 - Query: 
        SELECT 
            u.id,
            u.full_name as student_name,
            u.email,
            u.student_id,
            u.avatar_url,
            u.current_semester,
            COALESCE(p.name, 'Unassigned') as program_name,
            COALESCE(bp.risk_level, 'unknown') as risk_level,
            COALESCE(bp.risk_score, 0) as risk_score,
            COALESCE(bp.overall_engagement_score, 0) as overall_engagement_score,
            COALESCE(bp.on_time_submission_rate, 0) as on_time_submission_rate,
            COALESCE(bp.study_consistency_score, 0) as study_consistency_score,
            COALESCE(bp.grade_trend, 'unknown') as grade_trend,
            COALESCE(bp.total_logins, 0) as total_logins,
            COALESCE(bp.days_active, 0) as days_active,
            bp.risk_factors,
            bp.week_start,
            bp.calculated_at,
            COUNT(DISTINCT CASE WHEN i.status IN ('pending', 'in_progress') THEN i.id END) as open_interventions,
            MAX(i.created_at) as last_intervention_date,
            MAX(i.status) as last_intervention_status
        FROM users u
        LEFT JOIN programs p ON u.program_id = p.id
        LEFT JOIN behavior_patterns bp ON u.id = bp.user_id 
            AND bp.week_start = (SELECT MAX(week_start) FROM behavior_patterns)
        LEFT JOIN interventions i ON u.id = i.student_id
        WHERE u.role = 'student'
        AND u.is_active = 1
     AND bp.risk_level = ? AND u.program_id = ? GROUP BY u.id, bp.id, p.id ORDER BY bp.risk_score DESC, bp.overall_engagement_score ASC LIMIT ? OFFSET ?
